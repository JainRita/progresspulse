{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/hp/OneDrive/Documents/rita/my-app/actions/projects.js"],"sourcesContent":["\"use server\";\n\nimport { db } from \"@/lib/prisma\";\nimport { auth, clerkClient } from \"@clerk/nextjs/server\";\n\nexport async function createProject(data) {\n  const { userId, orgId } = auth();\n\n  if (!userId) {\n    throw new Error(\"Unauthorized\");\n  }\n\n  if (!orgId) {\n    throw new Error(\"No Organization Selected\");\n  }\n\n  // Check if the user is an admin of the organization\n  const { data: membershipList } =\n    await clerkClient().organizations.getOrganizationMembershipList({\n      organizationId: orgId,\n    });\n\n  const userMembership = membershipList.find(\n    (membership) => membership.publicUserData.userId === userId\n  );\n\n  if (!userMembership || userMembership.role !== \"org:admin\") {\n    throw new Error(\"Only organization admins can create projects\");\n  }\n\n  try {\n    const project = await db.project.create({\n      data: {\n        name: data.name,\n        key: data.key,\n        description: data.description,\n        organizationId: orgId,\n      },\n    });\n\n    return project;\n  } catch (error) {\n    throw new Error(\"Error creating project: \" + error.message);\n  }\n}\n\nexport async function getProject(projectId) {\n  const { userId, orgId } = auth();\n\n  if (!userId || !orgId) {\n    throw new Error(\"Unauthorized\");\n  }\n\n  // Find user to verify existence\n  const user = await db.user.findUnique({\n    where: { clerkUserId: userId },\n  });\n\n  if (!user) {\n    throw new Error(\"User not found\");\n  }\n\n  // Get project with sprints and organization\n  const project = await db.project.findUnique({\n    where: { id: projectId },\n    include: {\n      sprints: {\n        orderBy: { createdAt: \"desc\" },\n      },\n    },\n  });\n\n  if (!project) {\n    throw new Error(\"Project not found\");\n  }\n\n  // Verify project belongs to the organization\n  if (project.organizationId !== orgId) {\n    return null;\n  }\n\n  return project;\n}\n\nexport async function deleteProject(projectId) {\n  const { userId, orgId, orgRole } = auth();\n\n  if (!userId || !orgId) {\n    throw new Error(\"Unauthorized\");\n  }\n\n  if (orgRole !== \"org:admin\") {\n    throw new Error(\"Only organization admins can delete projects\");\n  }\n\n  const project = await db.project.findUnique({\n    where: { id: projectId },\n  });\n\n  if (!project || project.organizationId !== orgId) {\n    throw new Error(\n      \"Project not found or you don't have permission to delete it\"\n    );\n  }\n\n  await db.project.delete({\n    where: { id: projectId },\n  });\n\n  return { success: true };\n}"],"names":[],"mappings":";;;;;;;AAEA;;AACA;AAAA;;;;;AAEO,eAAe,uCAAW,GAAX,cAAc,IAAI;IACtC,MAAM,EAAE,MAAM,EAAE,KAAK,EAAE,GAAG,CAAA,GAAA,mLAAA,CAAA,OAAI,AAAD;IAE7B,IAAI,CAAC,QAAQ;QACX,MAAM,IAAI,MAAM;IAClB;IAEA,IAAI,CAAC,OAAO;QACV,MAAM,IAAI,MAAM;IAClB;IAEA,oDAAoD;IACpD,MAAM,EAAE,MAAM,cAAc,EAAE,GAC5B,MAAM,CAAA,GAAA,yKAAA,CAAA,cAAW,AAAD,IAAI,aAAa,CAAC,6BAA6B,CAAC;QAC9D,gBAAgB;IAClB;IAEF,MAAM,iBAAiB,eAAe,IAAI,CACxC,CAAC,aAAe,WAAW,cAAc,CAAC,MAAM,KAAK;IAGvD,IAAI,CAAC,kBAAkB,eAAe,IAAI,KAAK,aAAa;QAC1D,MAAM,IAAI,MAAM;IAClB;IAEA,IAAI;QACF,MAAM,UAAU,MAAM,6GAAA,CAAA,KAAE,CAAC,OAAO,CAAC,MAAM,CAAC;YACtC,MAAM;gBACJ,MAAM,KAAK,IAAI;gBACf,KAAK,KAAK,GAAG;gBACb,aAAa,KAAK,WAAW;gBAC7B,gBAAgB;YAClB;QACF;QAEA,OAAO;IACT,EAAE,OAAO,OAAO;QACd,MAAM,IAAI,MAAM,6BAA6B,MAAM,OAAO;IAC5D;AACF;AAEO,eAAe,uCAAQ,GAAR,WAAW,SAAS;IACxC,MAAM,EAAE,MAAM,EAAE,KAAK,EAAE,GAAG,CAAA,GAAA,mLAAA,CAAA,OAAI,AAAD;IAE7B,IAAI,CAAC,UAAU,CAAC,OAAO;QACrB,MAAM,IAAI,MAAM;IAClB;IAEA,gCAAgC;IAChC,MAAM,OAAO,MAAM,6GAAA,CAAA,KAAE,CAAC,IAAI,CAAC,UAAU,CAAC;QACpC,OAAO;YAAE,aAAa;QAAO;IAC/B;IAEA,IAAI,CAAC,MAAM;QACT,MAAM,IAAI,MAAM;IAClB;IAEA,4CAA4C;IAC5C,MAAM,UAAU,MAAM,6GAAA,CAAA,KAAE,CAAC,OAAO,CAAC,UAAU,CAAC;QAC1C,OAAO;YAAE,IAAI;QAAU;QACvB,SAAS;YACP,SAAS;gBACP,SAAS;oBAAE,WAAW;gBAAO;YAC/B;QACF;IACF;IAEA,IAAI,CAAC,SAAS;QACZ,MAAM,IAAI,MAAM;IAClB;IAEA,6CAA6C;IAC7C,IAAI,QAAQ,cAAc,KAAK,OAAO;QACpC,OAAO;IACT;IAEA,OAAO;AACT;AAEO,eAAe,uCAAW,GAAX,cAAc,SAAS;IAC3C,MAAM,EAAE,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE,GAAG,CAAA,GAAA,mLAAA,CAAA,OAAI,AAAD;IAEtC,IAAI,CAAC,UAAU,CAAC,OAAO;QACrB,MAAM,IAAI,MAAM;IAClB;IAEA,IAAI,YAAY,aAAa;QAC3B,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,UAAU,MAAM,6GAAA,CAAA,KAAE,CAAC,OAAO,CAAC,UAAU,CAAC;QAC1C,OAAO;YAAE,IAAI;QAAU;IACzB;IAEA,IAAI,CAAC,WAAW,QAAQ,cAAc,KAAK,OAAO;QAChD,MAAM,IAAI,MACR;IAEJ;IAEA,MAAM,6GAAA,CAAA,KAAE,CAAC,OAAO,CAAC,MAAM,CAAC;QACtB,OAAO;YAAE,IAAI;QAAU;IACzB;IAEA,OAAO;QAAE,SAAS;IAAK;AACzB;;;IAzGsB;IAyCA;IAsCA;;AA/EA,+OAAA;AAyCA,+OAAA;AAsCA,+OAAA"}},
    {"offset": {"line": 122, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 128, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/hp/OneDrive/Documents/rita/my-app/app/%28main%29/project/_components/create-sprint.jsx/proxy.js"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/app/(main)/project/_components/create-sprint.jsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/(main)/project/_components/create-sprint.jsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAoT,GACjV,kFACA"}},
    {"offset": {"line": 136, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 142, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/hp/OneDrive/Documents/rita/my-app/app/%28main%29/project/_components/create-sprint.jsx/proxy.js"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/app/(main)/project/_components/create-sprint.jsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/(main)/project/_components/create-sprint.jsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAgS,GAC7T,8DACA"}},
    {"offset": {"line": 150, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 156, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 160, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 166, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/hp/OneDrive/Documents/rita/my-app/app/%28main%29/project/_components/sprint-board.jsx/proxy.js"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/app/(main)/project/_components/sprint-board.jsx <module evaluation> from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/(main)/project/_components/sprint-board.jsx <module evaluation>\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAAmT,GAChV,iFACA"}},
    {"offset": {"line": 174, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 180, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/hp/OneDrive/Documents/rita/my-app/app/%28main%29/project/_components/sprint-board.jsx/proxy.js"],"sourcesContent":["import { registerClientReference } from \"react-server-dom-turbopack/server.edge\";\nexport default registerClientReference(\n    function() { throw new Error(\"Attempted to call the default export of [project]/app/(main)/project/_components/sprint-board.jsx from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.\"); },\n    \"[project]/app/(main)/project/_components/sprint-board.jsx\",\n    \"default\",\n);\n"],"names":[],"mappings":";;;AAAA;;uCACe,CAAA,GAAA,qPAAA,CAAA,0BAAuB,AAAD,EACjC;IAAa,MAAM,IAAI,MAAM;AAA+R,GAC5T,6DACA"}},
    {"offset": {"line": 188, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 194, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":""}},
    {"offset": {"line": 198, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 204, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/hp/OneDrive/Documents/rita/my-app/app/%28main%29/project/%5BprojectId%5D/page.jsx"],"sourcesContent":["import { getProject } from \"@/actions/projects\";\r\nimport { notFound } from \"next/navigation\";\r\nimport SprintCreationForm from \"../_components/create-sprint\";\r\nimport SprintBoard from \"../_components/sprint-board\";\r\n\r\nexport default async function ProjectPage({ params }) {\r\n  const { projectId } = params;\r\n  const project = await getProject(projectId);\r\n\r\n  if (!project) {\r\n    notFound();\r\n  }\r\n\r\n  return (\r\n    <div className=\"container mx-auto\">\r\n      <SprintCreationForm\r\n        projectTitle={project.name}\r\n        projectId={projectId}\r\n        projectKey={project.key}\r\n        sprintKey={project.sprints?.length + 1}\r\n      />\r\n\r\n      {project.sprints.length > 0 ? (\r\n        <SprintBoard\r\n          sprints={project.sprints}\r\n          projectId={projectId}\r\n          orgId={project.organizationId}\r\n        />\r\n      ) : (\r\n        <div>Create a Sprint from button above</div>\r\n      )}\r\n    </div>\r\n  );\r\n}"],"names":[],"mappings":";;;;AAAA;AACA;AACA;AACA;AAFA;;;;;;AAIe,eAAe,YAAY,EAAE,MAAM,EAAE;IAClD,MAAM,EAAE,SAAS,EAAE,GAAG;IACtB,MAAM,UAAU,MAAM,CAAA,GAAA,mHAAA,CAAA,aAAU,AAAD,EAAE;IAEjC,IAAI,CAAC,SAAS;QACZ,CAAA,GAAA,qLAAA,CAAA,WAAQ,AAAD;IACT;IAEA,qBACE,8OAAC;QAAI,WAAU;;0BACb,8OAAC,8JAAA,CAAA,UAAkB;gBACjB,cAAc,QAAQ,IAAI;gBAC1B,WAAW;gBACX,YAAY,QAAQ,GAAG;gBACvB,WAAW,QAAQ,OAAO,EAAE,SAAS;;;;;;YAGtC,QAAQ,OAAO,CAAC,MAAM,GAAG,kBACxB,8OAAC,6JAAA,CAAA,UAAW;gBACV,SAAS,QAAQ,OAAO;gBACxB,WAAW;gBACX,OAAO,QAAQ,cAAc;;;;;qCAG/B,8OAAC;0BAAI;;;;;;;;;;;;AAIb"}},
    {"offset": {"line": 259, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 271, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/hp/OneDrive/Documents/rita/my-app/actions/organizations.js"],"sourcesContent":["\"use server\";\n\nimport { db } from \"@/lib/prisma\";\nimport { auth, clerkClient } from \"@clerk/nextjs/server\";\n\nexport async function getOrganization(slug) {\n  const { userId } = auth();\n  if (!userId) {\n    throw new Error(\"Unauthorized\");\n  }\n\n  const user = await db.user.findUnique({\n    where: { clerkUserId: userId },\n  });\n\n  if (!user) {\n    throw new Error(\"User not found\");\n  }\n\n  // Get the organization details\n  const organization = await clerkClient().organizations.getOrganization({\n    slug,\n  });\n\n  if (!organization) {\n    return null;\n  }\n\n  // Check if user belongs to this organization\n  const { data: membership } =\n    await clerkClient().organizations.getOrganizationMembershipList({\n      organizationId: organization.id,\n    });\n\n  const userMembership = membership.find(\n    (member) => member.publicUserData.userId === userId\n  );\n\n  // If user is not a member, return null\n  if (!userMembership) {\n    return null;\n  }\n\n  return organization;\n}\n\nexport async function getProjects(orgId) {\n  const { userId } = auth();\n  if (!userId) {\n    throw new Error(\"Unauthorized\");\n  }\n\n  const user = await db.user.findUnique({\n    where: { clerkUserId: userId },\n  });\n\n  if (!user) {\n    throw new Error(\"User not found\");\n  }\n\n  const projects = await db.project.findMany({\n    where: { organizationId: orgId },\n    orderBy: { createdAt: \"desc\" },\n  });\n\n  return projects;\n}\n\nexport async function getUserIssues(userId) {\n  const { orgId } = auth();\n\n  if (!userId || !orgId) {\n    throw new Error(\"No user id or organization id found\");\n  }\n\n  const user = await db.user.findUnique({\n    where: { clerkUserId: userId },\n  });\n\n  if (!user) {\n    throw new Error(\"User not found\");\n  }\n\n  const issues = await db.issue.findMany({\n    where: {\n      OR: [{ assigneeId: user.id }, { reporterId: user.id }],\n      project: {\n        organizationId: orgId,\n      },\n    },\n    include: {\n      project: true,\n      assignee: true,\n      reporter: true,\n    },\n    orderBy: { updatedAt: \"desc\" },\n  });\n\n  return issues;\n}\n\nexport async function getOrganizationUsers(orgId) {\n  const { userId } = auth();\n  if (!userId) {\n    throw new Error(\"Unauthorized\");\n  }\n\n  const user = await db.user.findUnique({\n    where: { clerkUserId: userId },\n  });\n\n  if (!user) {\n    throw new Error(\"User not found\");\n  }\n\n  const organizationMemberships =\n    await clerkClient().organizations.getOrganizationMembershipList({\n      organizationId: orgId,\n    });\n\n  const userIds = organizationMemberships.data.map(\n    (membership) => membership.publicUserData.userId\n  );\n\n  const users = await db.user.findMany({\n    where: {\n      clerkUserId: {\n        in: userIds,\n      },\n    },\n  });\n\n  return users;\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 416, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 422, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/hp/OneDrive/Documents/rita/my-app/actions/issues.js"],"sourcesContent":["\"use server\";\n\nimport { db } from \"@/lib/prisma\";\nimport { auth } from \"@clerk/nextjs/server\";\n\nexport async function getIssuesForSprint(sprintId) {\n  const { userId, orgId } = auth();\n\n  if (!userId || !orgId) {\n    throw new Error(\"Unauthorized\");\n  }\n\n  const issues = await db.issue.findMany({\n    where: { sprintId: sprintId },\n    orderBy: [{ status: \"asc\" }, { order: \"asc\" }],\n    include: {\n      assignee: true,\n      reporter: true,\n    },\n  });\n\n  return issues;\n}\n\nexport async function createIssue(projectId, data) {\n  const { userId, orgId } = auth();\n\n  if (!userId || !orgId) {\n    throw new Error(\"Unauthorized\");\n  }\n\n  let user = await db.user.findUnique({ where: { clerkUserId: userId } });\n\n  const lastIssue = await db.issue.findFirst({\n    where: { projectId, status: data.status },\n    orderBy: { order: \"desc\" },\n  });\n\n  const newOrder = lastIssue ? lastIssue.order + 1 : 0;\n\n  const issue = await db.issue.create({\n    data: {\n      title: data.title,\n      description: data.description,\n      status: data.status,\n      priority: data.priority,\n      projectId: projectId,\n      sprintId: data.sprintId,\n      reporterId: user.id,\n      assigneeId: data.assigneeId || null, // Add this line\n      order: newOrder,\n    },\n    include: {\n      assignee: true,\n      reporter: true,\n    },\n  });\n\n  return issue;\n}\n\nexport async function updateIssueOrder(updatedIssues) {\n  const { userId, orgId } = auth();\n\n  if (!userId || !orgId) {\n    throw new Error(\"Unauthorized\");\n  }\n\n  // Start a transaction\n  await db.$transaction(async (prisma) => {\n    // Update each issue\n    for (const issue of updatedIssues) {\n      await prisma.issue.update({\n        where: { id: issue.id },\n        data: {\n          status: issue.status,\n          order: issue.order,\n        },\n      });\n    }\n  });\n\n  return { success: true };\n}\n\nexport async function deleteIssue(issueId) {\n  const { userId, orgId } = auth();\n\n  if (!userId || !orgId) {\n    throw new Error(\"Unauthorized\");\n  }\n\n  const user = await db.user.findUnique({\n    where: { clerkUserId: userId },\n  });\n\n  if (!user) {\n    throw new Error(\"User not found\");\n  }\n\n  const issue = await db.issue.findUnique({\n    where: { id: issueId },\n    include: { project: true },\n  });\n\n  if (!issue) {\n    throw new Error(\"Issue not found\");\n  }\n\n  if (\n    issue.reporterId !== user.id &&\n    !issue.project.adminIds.includes(user.id)\n  ) {\n    throw new Error(\"You don't have permission to delete this issue\");\n  }\n\n  await db.issue.delete({ where: { id: issueId } });\n\n  return { success: true };\n}\n\nexport async function updateIssue(issueId, data) {\n  const { userId, orgId } = auth();\n\n  if (!userId || !orgId) {\n    throw new Error(\"Unauthorized\");\n  }\n\n  try {\n    const issue = await db.issue.findUnique({\n      where: { id: issueId },\n      include: { project: true },\n    });\n\n    if (!issue) {\n      throw new Error(\"Issue not found\");\n    }\n\n    if (issue.project.organizationId !== orgId) {\n      throw new Error(\"Unauthorized\");\n    }\n\n    const updatedIssue = await db.issue.update({\n      where: { id: issueId },\n      data: {\n        status: data.status,\n        priority: data.priority,\n      },\n      include: {\n        assignee: true,\n        reporter: true,\n      },\n    });\n\n    return updatedIssue;\n  } catch (error) {\n    throw new Error(\"Error updating issue: \" + error.message);\n  }\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 612, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}},
    {"offset": {"line": 618, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/hp/OneDrive/Documents/rita/my-app/actions/sprints.js"],"sourcesContent":["\"use server\";\n\nimport { db } from \"@/lib/prisma\";\nimport { auth } from \"@clerk/nextjs/server\";\n\nexport async function createSprint(projectId, data) {\n  const { userId, orgId } = auth();\n\n  if (!userId || !orgId) {\n    throw new Error(\"Unauthorized\");\n  }\n\n  const project = await db.project.findUnique({\n    where: { id: projectId },\n    include: { sprints: { orderBy: { createdAt: \"desc\" } } },\n  });\n\n  if (!project || project.organizationId !== orgId) {\n    throw new Error(\"Project not found\");\n  }\n\n  const sprint = await db.sprint.create({\n    data: {\n      name: data.name,\n      startDate: data.startDate,\n      endDate: data.endDate,\n      status: \"PLANNED\",\n      projectId: projectId,\n    },\n  });\n\n  return sprint;\n}\n\nexport async function updateSprintStatus(sprintId, newStatus) {\n  const { userId, orgId, orgRole } = auth();\n\n  if (!userId || !orgId) {\n    throw new Error(\"Unauthorized\");\n  }\n\n  try {\n    const sprint = await db.sprint.findUnique({\n      where: { id: sprintId },\n      include: { project: true },\n    });\n    console.log(sprint, orgRole);\n\n    if (!sprint) {\n      throw new Error(\"Sprint not found\");\n    }\n\n    if (sprint.project.organizationId !== orgId) {\n      throw new Error(\"Unauthorized\");\n    }\n\n    if (orgRole !== \"org:admin\") {\n      throw new Error(\"Only Admin can make this change\");\n    }\n\n    const now = new Date();\n    const startDate = new Date(sprint.startDate);\n    const endDate = new Date(sprint.endDate);\n\n    if (newStatus === \"ACTIVE\" && (now < startDate || now > endDate)) {\n      throw new Error(\"Cannot start sprint outside of its date range\");\n    }\n\n    if (newStatus === \"COMPLETED\" && sprint.status !== \"ACTIVE\") {\n      throw new Error(\"Can only complete an active sprint\");\n    }\n\n    const updatedSprint = await db.sprint.update({\n      where: { id: sprintId },\n      data: { status: newStatus },\n    });\n\n    return { success: true, sprint: updatedSprint };\n  } catch (error) {\n    throw new Error(error.message);\n  }\n}"],"names":[],"mappings":";;;;;;AAEA;;AACA;;;;;AAEO,eAAe,uCAAU,GAAV,aAAa,SAAS,EAAE,IAAI;IAChD,MAAM,EAAE,MAAM,EAAE,KAAK,EAAE,GAAG,CAAA,GAAA,mLAAA,CAAA,OAAI,AAAD;IAE7B,IAAI,CAAC,UAAU,CAAC,OAAO;QACrB,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,UAAU,MAAM,6GAAA,CAAA,KAAE,CAAC,OAAO,CAAC,UAAU,CAAC;QAC1C,OAAO;YAAE,IAAI;QAAU;QACvB,SAAS;YAAE,SAAS;gBAAE,SAAS;oBAAE,WAAW;gBAAO;YAAE;QAAE;IACzD;IAEA,IAAI,CAAC,WAAW,QAAQ,cAAc,KAAK,OAAO;QAChD,MAAM,IAAI,MAAM;IAClB;IAEA,MAAM,SAAS,MAAM,6GAAA,CAAA,KAAE,CAAC,MAAM,CAAC,MAAM,CAAC;QACpC,MAAM;YACJ,MAAM,KAAK,IAAI;YACf,WAAW,KAAK,SAAS;YACzB,SAAS,KAAK,OAAO;YACrB,QAAQ;YACR,WAAW;QACb;IACF;IAEA,OAAO;AACT;AAEO,eAAe,uCAAgB,GAAhB,mBAAmB,QAAQ,EAAE,SAAS;IAC1D,MAAM,EAAE,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE,GAAG,CAAA,GAAA,mLAAA,CAAA,OAAI,AAAD;IAEtC,IAAI,CAAC,UAAU,CAAC,OAAO;QACrB,MAAM,IAAI,MAAM;IAClB;IAEA,IAAI;QACF,MAAM,SAAS,MAAM,6GAAA,CAAA,KAAE,CAAC,MAAM,CAAC,UAAU,CAAC;YACxC,OAAO;gBAAE,IAAI;YAAS;YACtB,SAAS;gBAAE,SAAS;YAAK;QAC3B;QACA,QAAQ,GAAG,CAAC,QAAQ;QAEpB,IAAI,CAAC,QAAQ;YACX,MAAM,IAAI,MAAM;QAClB;QAEA,IAAI,OAAO,OAAO,CAAC,cAAc,KAAK,OAAO;YAC3C,MAAM,IAAI,MAAM;QAClB;QAEA,IAAI,YAAY,aAAa;YAC3B,MAAM,IAAI,MAAM;QAClB;QAEA,MAAM,MAAM,IAAI;QAChB,MAAM,YAAY,IAAI,KAAK,OAAO,SAAS;QAC3C,MAAM,UAAU,IAAI,KAAK,OAAO,OAAO;QAEvC,IAAI,cAAc,YAAY,CAAC,MAAM,aAAa,MAAM,OAAO,GAAG;YAChE,MAAM,IAAI,MAAM;QAClB;QAEA,IAAI,cAAc,eAAe,OAAO,MAAM,KAAK,UAAU;YAC3D,MAAM,IAAI,MAAM;QAClB;QAEA,MAAM,gBAAgB,MAAM,6GAAA,CAAA,KAAE,CAAC,MAAM,CAAC,MAAM,CAAC;YAC3C,OAAO;gBAAE,IAAI;YAAS;YACtB,MAAM;gBAAE,QAAQ;YAAU;QAC5B;QAEA,OAAO;YAAE,SAAS;YAAM,QAAQ;QAAc;IAChD,EAAE,OAAO,OAAO;QACd,MAAM,IAAI,MAAM,MAAM,OAAO;IAC/B;AACF;;;IA5EsB;IA6BA;;AA7BA,+OAAA;AA6BA,+OAAA"}},
    {"offset": {"line": 718, "column": 0}, "map": {"version":3,"sources":[],"names":[],"mappings":"A"}}]
}